(()=>{"use strict";const t=function(t,e){return new Promise(((n,o)=>{let i=new Anmo.Utils.PopupIncubator(!0,!1,!1);const a=Anmo.BuildElement({tag:"div",style:{"background-color":"white",width:"100px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center","background-color":"white",position:"absolute",top:e+"px",left:t+"px"},content:[Anmo.BuildElement({tag:"button",content:"Delete",attributes:[{attribute:"class",value:"context-button"}],onTap:async()=>{n("DELETE"),i.hidePopup()},style:{display:"flex","align-items":"center","text-align":"center",height:"30px",padding:"10px 10px","background-color":"#e3e3e3","font-weight":"bold",border:"none",width:"100%","justify-content":"center"}})]});i.displayPopup(a)}))},e=(t,n)=>{for(let o=0;o<t.length;o++){if(t[o].id===n)return t.splice(o,1),t;Array.isArray(t[o])&&e(t[o],n),"object"==typeof t[o]&&null!==t[o]&&(Array.isArray(t[o].content)?t[o].content=e(t[o].content,n):"object"==typeof t[o].content&&null!==t[o].content&&(t[o].content=e([t[o].content],n)))}return t},n=class extends Anmo.AbstractView{constructor(){super(),this.drawing=[],setTimeout((()=>this.init()),1e3),document.addEventListener("getDrawingLayout",(t=>{Anmo.AppLocalStorage.TemporaryData({key:"UIBuilderDrawingLayout",value:this.drawing})})),document.addEventListener("updateCSSDrawingPanel",(t=>{const{id:e,prop:n,value:o}=t.detail;this.drawing=this.bfsSearchAndUpdateCSS(this.drawing,e,n,o),setTimeout((()=>this.init()),500),this.update()}))}init(){const t=!!document.getElementById(this.id)&&document.getElementById(this.id);t?(t.addEventListener("dragover",(t=>t.preventDefault())),t.addEventListener("drop",(async t=>this.handleDrop(t)))):setTimeout((()=>this.init()),1e3)}bfsSearchAndUpdateCSS(t,e,n,o){let i=[...t];for(;i.length;){const a=i.shift();if(a.id===e)return a.style[n]=o,t;"object"==typeof a&&null!==a&&null!=a?.content&&(Array.isArray(a.content)?i.push(...a.content):i.push(a.content))}return t}bfsSearchAndUpdateContent(t,e,n){let o=[...t];for(;o.length;){const i=o.shift();if(i.id===e)return null==i.content?i.content=n:Array.isArray(i.content)?i.content.push(n):"object"==typeof i.content&&(i.content=[i.content,n]),t;"object"==typeof i&&null!==i&&null!=i?.content&&(Array.isArray(i.content)?o.push(...i.content):o.push(i.content))}return t}handleDrop(t,e=!1){t.preventDefault(),t.stopPropagation();const n=document.getElementById(t.dataTransfer.getData("text"));if(!n?.dataset?.component)return;const o=Anmo.AbstractView.generateID(),i=JSON.parse(n.dataset.component);e?this.drawing=this.bfsSearchAndUpdateContent(this.drawing,e,{id:o,...i}):this.drawing.push({id:o,...i}),setTimeout((()=>this.init()),500),this.update()}draw(n){let o=[];if(Array.isArray(n)){for(let i=0;i<n.length;i++){const a=n[i],r=a?.content?this.draw(a.content):[],s=Anmo.BuildElement({...a,content:r,onTap:t=>{t.stopPropagation(),console.log("test",a.id),document.dispatchEvent(new CustomEvent("showComponentToolSet",{detail:{id:a.id}}))},onContextMenu:async n=>{n.preventDefault(),n.stopPropagation(),"DELETE"===await t(n.clientX,n.clientY)&&(this.drawing=e(this.drawing,a.id),setTimeout((()=>this.init()),500),this.update())}});s.addEventListener("drop",(t=>this.handleDrop(t,a.id))),o.push(s)}return o}if("object"==typeof n&&null!==n&&!Array.isArray(n)){const i=n?.content?this.draw(n.content):[],a=Anmo.BuildElement({...n,content:i,onTap:t=>{t.stopPropagation(),console.log("test",n.id),document.dispatchEvent(new CustomEvent("showComponentToolSet",{detail:{id:n.id}}))},onContextMenu:async o=>{o.preventDefault(),o.stopPropagation();const i=await t(o.clientX,o.clientY);console.log(i),"DELETE"===i&&(this.drawing=e(this.drawing,n.id),setTimeout((()=>this.init()),500),this.update())}});return a.addEventListener("dragover",(t=>t.preventDefault())),a.addEventListener("drop",(async t=>this.handleDrop(t,n.id))),o.push(a),o}}getComponentHTML(){try{return Anmo.BuildElement({tag:"div",id:this.id,style:{width:"inherit",border:"2px solid #bfbfbf",padding:"10px","overflow-y":"auto"},attributes:[{attribute:"class",value:this.drawing.length>0?"":"drawing-panel-cover"}],content:[...this.draw(this.drawing)]})}catch(t){return console.log(t),this.componentError(t)}}},o=class extends Anmo.AbstractView{constructor(t){super(),this.info=t}getComponentHTML(){try{return Anmo.BuildElement({tag:"div",id:this.id,attributes:[{attribute:"draggable",value:"true"},{attribute:"ondragstart",value:`event.dataTransfer.setData('text', '${this.id}')`},{attribute:"data-component",value:JSON.stringify(this.info.data)},{attribute:"class",value:"hovercard"},{attribute:"title",value:"container"}],style:{width:"100px",height:"100px",border:"2px solid #bfbfbf",display:"flex","justify-content":"center",gap:"10px","align-items":"center","flex-direction":"column","border-radius":"5px"},content:[Anmo.BuildElement({tag:"img",attributes:[{attribute:"src",value:"./media/logo.png"},{attribute:"draggable",value:"false"}],style:{width:"80%"}}),Anmo.BuildElement({tag:"p",style:{margin:"0px"},content:this.info.title})]})}catch(t){return console.log("error:"+t),this.componentError(t)}}},i=JSON.parse('[{"name":"background-color","value_options":"color","type":"color"},{"name":"color","value_options":"color","type":"color"},{"name":"font-family","value_options":"font-family","type":"text"},{"name":"font-size","value_options":"size","type":"text"},{"name":"font-weight","value_options":["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],"type":"text"},{"name":"text-align","value_options":["left","right","center","justify"],"type":"text"},{"name":"text-decoration","value_options":["none","underline","overline","line-through"],"type":"text"},{"name":"text-transform","value_options":["none","capitalize","uppercase","lowercase"],"type":"text"},{"name":"width","value_options":"size","type":"text"},{"name":"height","value_options":"size","type":"text"},{"name":"display","value_options":["none","block","inline","inline-block","flex"],"type":"text"},{"name":"float","value_options":["left","right","none"],"type":"text"},{"name":"position","value_options":["static","relative","absolute","fixed"],"type":"text"},{"name":"top","value_options":"size","type":"text"},{"name":"bottom","value_options":"size","type":"text"},{"name":"left","value_options":"size","type":"text"},{"name":"right","value_options":"size","type":"text"},{"name":"border","value_options":["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],"type":"text"},{"name":"border-radius","value_options":"size","type":"text"},{"name":"border-color","value_options":"color","type":"color"},{"name":"border-width","value_options":"size","type":"text"},{"name":"margin","value_options":"size","type":"text"},{"name":"padding","value_options":"size","type":"text"},{"name":"opacity","value_options":["0","0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1"],"type":"text"},{"name":"overflow","value_options":["visible","hidden","scroll","auto"],"type":"text"},{"name":"z-index","value_options":"number","type":"number"},{"name":"box-shadow","value_options":["none","h-shadow v-shadow blur spread color","inset h-shadow v-shadow blur spread color"],"type":"text"},{"name":"text-shadow","value_options":["none","h-shadow v-shadow blur color"],"type":"text"},{"name":"line-height","value_options":"number","type":"number"},{"name":"vertical-align","value_options":["baseline","top","middle","bottom"],"type":"text"},{"name":"cursor","value_options":["auto","default","pointer","text","move","not-allowed","crosshair"],"type":"text"}]'),a=class extends Anmo.AbstractView{constructor(t){super(),this.eid=t}updateCSSDrawingPanel(t,e){document.dispatchEvent(new CustomEvent("updateCSSDrawingPanel",{detail:{prop:e,value:t,id:this.eid}}))}drawCssPropertyControl(t){return Anmo.BuildElement({tag:"div",style:{width:"100%",display:"flex","justify-content":"space-between","align-items":"center"},content:[Anmo.BuildElement({tag:"p",style:{margin:"0px","font-size":"13px"},content:t.name}),((t,e)=>{if(Array.isArray(t))return Anmo.BuildElement({tag:"select",onChange:t=>{this.updateCSSDrawingPanel(t.target.value,e)},style:{width:"24%"},content:t.map((t=>Anmo.BuildElement({tag:"option",content:t})))});switch(t){case"text":case"size":case"number":case"font-family":return Anmo.BuildElement({tag:"input",onInput:t=>{this.updateCSSDrawingPanel(t.target.value,e)},attributes:[{attribute:"type",value:"text"}],style:{width:"20%"}});case"color":return Anmo.BuildElement({tag:"input",onInput:t=>{this.updateCSSDrawingPanel(t.target.value,e)},attributes:[{attribute:"type",value:"color"}],style:{width:"24%"}})}})(t.value_options,t.name)]})}getComponentHTML(){try{return Anmo.BuildElement({tag:"div",id:this.id,style:{display:"flex","flex-direction":"column",gap:"20px",padding:"10px 5px"},content:[...i.map((t=>this.drawCssPropertyControl(t)))]})}catch(t){return this.componentError(t)}}},r=JSON.parse('[{"title":"Column","data":{"tag":"div","attributes":[{"attribute":"draggable","value":"true"},{"attribute":"class","value":"edit-container-drawing"}],"style":{"height":"auto","padding":"20px 10px"}}},{"title":"Row","data":{"tag":"div","attributes":[{"attribute":"draggable","value":"true"},{"attribute":"class","value":"edit-container-drawing"}],"style":{"height":"auto","padding":"20px 10px","display":"flex","gap":"10px"}}}]'),s=class extends Anmo.AbstractView{constructor(){super(),this.flag=!0,this.panelTitle="",document.addEventListener("showComponentToolSet",(t=>{this.flag=!1,this.panelTitle=t.detail.id,this.update()}))}getComponentHTML(){try{const t=Anmo.BuildElement({tag:"div",id:this.id,style:{width:"220px","min-width":"220px",display:"flex","justify-items":"center",padding:"10px",gap:"10px","flex-wrap":"wrap",border:"2px solid #bfbfbf","align-content":"flex-start"},content:[...r.map((t=>new o(t).getComponentHTML()))]}),e=Anmo.BuildElement({tag:"div",id:this.id,style:{width:"220px","min-width":"220px",border:"2px solid #bfbfbf","overflow-y":"auto","overflow-x":"hidden"},content:[Anmo.BuildElement({tag:"div",style:{width:"220px","min-width":"220px",display:"flex",gap:"10px",padding:"10px 5px","background-color":"black"},content:[Anmo.BuildElement({tag:"button",onTap:()=>{this.flag=!0,this.update()},style:{width:"25px",height:"25px","border-radius":"10px",display:"flex","align-items":"center","justify-content":"center",background:"white",cursor:"pointer"},content:"x"})]}),new a(this.panelTitle).getComponentHTML()]});return this.flag?t:e}catch(t){return this.componentError(t)}}},l=t=>{let e="";if(Array.isArray(t))return t.forEach((t=>{let n=t?.content?`,content: ${l(t?.content)}`:"";delete t.content;const o=`Anmo.BuildElement(${JSON.stringify(t).slice(0,-1)} ${n}}),`;e+=o})),`[${e}]`;if("object"==typeof t){let n=t?.content?`,content: ${l(t?.content)}`:"";return delete t.content,e=`Anmo.BuildElement(${JSON.stringify(t).slice(0,-1)} ${n}}),`,e}return"string"==typeof t||t instanceof String?(e=t,e):void 0},d=class extends Anmo.AbstractView{constructor(){super()}getLayout(){document.dispatchEvent(new CustomEvent("getDrawingLayout")),setTimeout((()=>{const t=Anmo.AppLocalStorage.getTemporaryData("UIBuilderDrawingLayout");this.layout=JSON.parse(t),(t=>{let e=l(t);var n="export.js",o=new Blob([`\n        export default class extends Anmo.AbstractView { \n            constructor() {\n                super();\n            }\n        \n            getComponentHTML() {\n                try {\n                    return Anmo.BuildElement ({\n                        tag: 'div',\n                        id: this.id,\n                        content: ${e}\n                    });\n                } catch (error) {\n                    return this.componentError(error);\n                }\n            }\n        }\n    `],{type:"text/javascript;"});if(navigator.msSaveBlob)navigator.msSaveBlob(o,n);else{var i=document.createElement("a");if(void 0!==i.download){var a=URL.createObjectURL(o);i.setAttribute("href",a),i.setAttribute("download",n),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}})(this.layout)}),1e3)}getComponentHTML(){try{return Anmo.BuildElement({tag:"div",id:this.id,style:{width:"100%",height:"40px",display:"flex","flex-direction":"row-reverse","background-color":"#bfbfbf    "},content:[Anmo.BuildElement({tag:"button",onTap:()=>this.getLayout(),style:{width:"40px",height:"40px",border:"none",display:"flex","align-items":"center","justify-content":"center",background:"transparent",cursor:"pointer"},content:Anmo.BuildElement({tag:"i",attributes:[{attribute:"class",value:"arrow down"}]})})]})}catch(t){return this.componentError(t)}}};Anmo.setBreakPoints({mobile:450,tablet:850}),Anmo.setMainContainer("body"),Anmo.initApp(class extends Anmo.AbstractView{constructor(){super()}getComponentHTML(){try{return Anmo.BuildElement({tag:"div",id:this.id,style:{width:"100%",height:"100%"},content:[(new d).getComponentHTML(),Anmo.BuildElement({tag:"div",style:{display:"flex",width:"100%",height:"100%"},content:[(new s).getComponentHTML(),(new n).getComponentHTML()]})]})}catch(t){return this.componentError(t)}}})})();